**Date**: 2025-05-19 19:28

**Topics**:  [[database]]  [[indexing]] 

**Category**: #system-design 

## Notes :

	What is indexing :

 - It is used to increase performance of database query. So data is fetched faster.
 - Without indexing , DBMS has to iterate each and every table row to find the requested data.
 
	 # B+ Tree :
	 - B+ tree provided O(log N) time complexity for insertion , searching & deletion.
	 - It maintains sorted data.
	 - All leaf are at same level.
	 - M order B tree means , each node can have at most M children.
	 - and M-1 keys per node.


	# 3-order B tree : 
	![[Pasted image 20250519194515.png]]

	# DBMS usage of B+ Tree :
	- Root node or intermediate node holds the value which is used for faster searching the data. Possible that value might be deleted from DB (can still be used to sort the tree).
	- Leaf node holds the indexed column value.

	![[Pasted image 20250519194908.png]]
	
	![[Pasted image 20250519195115.png]]

	- We apply B+ tree on the indexed column data. 

	# Types of Indexing 
	
	1. **Clustered Indexing**
		- Order of rows inside the data pages , match the order of index.
		- There can be only 1 clustered index per table.
		- If we don't set any clustered key , primary key is used by DBMS.
		- If table doesn't have any primary key , internally it creates a hidden column which is used as clustered key.
	
	2. **Non-Clustered Indexing**
		- It creates a logical order for data rows but does not affect their physical order in the table.


## Steps to Search Indexed Data in a Database

1. **Query is received**  
   e.g., `SELECT * FROM table WHERE column = value`.

2. **Query optimiser checks available indexes**  
   Determines if an index can be used for the search.

3. **Index (B-Tree or B+ Tree) is traversed**  
   Navigates from root to leaf based on the search key.

4. **Leaf node is reached**  
   Contains:
   - Full row (if clustered index), or
   - Row pointer (if non-clustered index)

5. **Data is fetched**  
   - **Clustered index**: data is returned directly.
   - **Non-clustered index**: pointer is used to locate the actual row in the table.

6. **Result is returned**  
   Final data is returned to the user/application.


## B-Tree v/s B+ Tree

|Feature|**B-Tree**|**B+ Tree**|
|---|---|---|
|**Data Storage**|Keys and data are stored **in both internal and leaf nodes**.|All data/records are stored **only in leaf nodes**.|
|**Search Efficiency**|May need to search internal nodes that store data.|Internal nodes store only keys, making searching more efficient.|
|**Leaf Node Structure**|Leaf nodes are **not linked**.|Leaf nodes are **linked sequentially**, aiding range queries.|
|**Traversal for Range**|Slower for range queries as you need tree traversal.|Fast and efficient for **range queries** (e.g., WHERE a < x < b).|
|**Tree Height**|Slightly shorter, as data is stored at multiple levels.|May be taller since all data is at the bottom level.|
|**Redundancy**|Less redundancy (data appears once).|More redundancy (same keys in internal and leaf nodes).|
|**Use Case**|Suitable for in-memory indexing.|Preferred for **disk-based** or database indexing.|




## References :

- https://www.cs.usfca.edu/~galles/visualization/BPlusTree.html
- https://youtu.be/_nY8yR6iqx4?si=8Tetyf3M2CIPiAYp